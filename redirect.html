<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Rejigthesystem by ankit96</title>
    <script type="text/javascript" src="codebird.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>


  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Rejigthesystem</h1>
          <h2>Bot to listen your complaints and make the person who can solve your issue listen them</h2>
        </header>

       
        <section id="main_content">
          <div id="demo">
            <h3> demo
            </h3>
         

            <p id="hi"></p>
            <p id="hello"></p>
            <p id="text"></p>
          Tweet:<br>
            <input type="text" id ="tweet" name="tweet" value=""><br>
             <button id="twitter">
          Twitter
          </button>
            
           
          </div>
        </section>
        <footer>
          Rejigthesystem is maintained by <a href="https://github.com/ankit96">ankit96</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>


      </div>
    </div>
    <script>
   
    $(function () {
  
  $('#twitter').click(function (e) {
    e.preventDefault();

    
    var cb = new Codebird;
    
   var current_url = location.toString();
   var p1=location.oauth_token;
   var p2= location.oauth_verifier;
    //parameters1 = url.match(/\#(?:oauth_token)\=([\S\s]*?)\&/)[1];
    //parameters2= url.match(/\#(?:oauth_verifier)\=([\S\s]*?)\&/)[1];
var regex = /(=)\w+/g;
var tokens = current_url.match(regex); //gives ["{string1}", "{string2}"]
 tokens[0]=tokens[0].slice(1);
 tokens[1]=tokens[1].slice(1);
cb.setConsumerKey("PlO8d5fGDyKPkA3GMOdImljTz", "u5944xZy9GPsg5A3OIySMjeSZ6qIFRkMbG9d9NcBpEjeovB07i");


 var oauth_token = localStorage.getItem("oauth_token");
  var oauth_token_secret = localStorage.getItem("oauth_token_secret");
  //var current_url = localStorage.getItem("current_url");
  document.getElementById("hi").innerHTML =oauth_token + " - -- -  "+ oauth_token_secret+"-- -- --"+current_url ;
cb.setConsumerKey("PlO8d5fGDyKPkA3GMOdImljTz", "u5944xZy9GPsg5A3OIySMjeSZ6qIFRkMbG9d9NcBpEjeovB07i");

//var parameters1=parameters.oauth_token;//localStorage.getItem("oauth_token1");
//var parameters2 = parameters.oauth_verifier;//localStorage.getItem("oauth_token_secret1");
document.getElementById("hello").innerHTML =tokens[0] + " - -- -  "+ tokens[1] ;
// check if oauth_verifier is set
if (typeof tokens[1] !== "undefined") {
    // assign stored request token parameters to codebird here
    // ...
    cb.setToken(oauth_token, oauth_token_secret);

    cb.__call(
        "oauth_accessToken",
        {
            oauth_verifier: tokens[1]
        },
        function (reply, rate, err) {
            if (err) {
                console.log("error response or timeout exceeded" + err.error);
            }
            if (reply) {
              var tweetit = document.getElementById('tweet').value;
                cb.setToken(reply.oauth_token, reply.oauth_token_secret);
                 localStorage.setItem("final_oauth_token", reply.oauth_token);
            localStorage.setItem("final_oauth_token_secret", reply.oauth_token_secret);
          //alert(reply.oauth_token)
               document.getElementById("text").innerHTML =reply.oauth_token + " "+reply.oauth_token_secret ;

               cb.__call(
    "statuses_update",
    {"status": tweetit},
    function (reply, rate, err) {
        // ...
    }
);
               cb.__call(
    "statuses_homeTimeline",
    {},
    function (reply, rate, err) {
        console.log(reply);
        console.log(err);
        alert(reply[0].description)
    }
);
            }
            // if you need to persist the login after page reload,
            // consider storing the token in a cookie or HTML5 local storage
        }
    );
}
  
   
    
     //document.getElementById("text").innerHTML =oauth_token + " "oauth_token_secret ;
     
    //cb.setToken(oauth_token, oauth_token_secret);
   

 
              });
          });
       
</script>
  </body>
</html>
